Begin to load knowledge graph triples ...
100%|##########| 31036/31036 [00:00<00:00, 1070196.48it/s]
kg shape:  (9366, 9366)
number of edges in KG:  19586
2024-07-12 09:38:20.420043: Load Data
USER 1815 ITEM 3846
NUM OF INTERACTIONS 17523
2024-07-12 09:38:21.108044: Model Prepared
2024-07-12 09:38:21.108044: Model Initialized
2024-07-12 09:38:22.510045: 
2024-07-12 09:38:22.510045: Start to re-build kg
2024-07-12 09:38:25.371050: KG built!
2024-07-12 09:38:25.740050: Epoch 0/40, Train: Loss = 1.9395, recLoss = 0.4585, clLoss = 1.4809, diLoss = 0.0006, CKDLoss = 0.0000  
2024-07-12 09:38:25.999050: Epoch 0/40, Test: Recall = 0.2001, NDCG = 0.1079  

2024-07-12 09:38:26.738051: 
2024-07-12 09:38:26.738051: Start to re-build kg
2024-07-12 09:38:31.960561: KG built!
2024-07-12 09:38:32.541562: Epoch 1/40, Train: Loss = 1.7046, recLoss = 0.2133, clLoss = 1.4912, diLoss = 0.0008, CKDLoss = 0.0000  
2024-07-12 09:38:32.859562: Epoch 1/40, Test: Recall = 0.2877, NDCG = 0.1551  

2024-07-12 09:38:33.602563: 
2024-07-12 09:38:33.602563: Start to re-build kg
2024-07-12 09:38:38.235569: KG built!
2024-07-12 09:38:38.614569: Epoch 2/40, Train: Loss = 1.6203, recLoss = 0.1295, clLoss = 1.4907, diLoss = 0.0005, CKDLoss = 0.0002  
2024-07-12 09:38:38.789569: Epoch 2/40, Test: Recall = 0.3103, NDCG = 0.1694  

2024-07-12 09:38:39.468570: 
2024-07-12 09:38:39.468570: Start to re-build kg
2024-07-12 09:38:44.113576: KG built!
2024-07-12 09:38:44.641577: Epoch 3/40, Train: Loss = 1.5840, recLoss = 0.0969, clLoss = 1.4871, diLoss = 0.0013, CKDLoss = 0.0010  
2024-07-12 09:38:45.024577: Epoch 3/40, Test: Recall = 0.3203, NDCG = 0.1759  

2024-07-12 09:38:45.801578: 
2024-07-12 09:38:45.801578: Start to re-build kg
2024-07-12 09:38:50.923585: KG built!
2024-07-12 09:38:51.507585: Epoch 4/40, Train: Loss = 1.5648, recLoss = 0.0803, clLoss = 1.4845, diLoss = 0.0011, CKDLoss = 0.0029  
2024-07-12 09:38:51.834585: Epoch 4/40, Test: Recall = 0.3267, NDCG = 0.1801  

2024-07-12 09:38:52.585587: 
2024-07-12 09:38:52.585587: Start to re-build kg
2024-07-12 09:38:55.415590: KG built!
2024-07-12 09:38:55.853590: Epoch 5/40, Train: Loss = 1.5566, recLoss = 0.0744, clLoss = 1.4821, diLoss = 0.0010, CKDLoss = 0.0047  
2024-07-12 09:38:56.097590: Epoch 5/40, Test: Recall = 0.3313, NDCG = 0.1847  

2024-07-12 09:38:56.789591: 
2024-07-12 09:38:56.789591: Start to re-build kg
2024-07-12 09:39:01.970605: KG built!
2024-07-12 09:39:02.533606: Epoch 6/40, Train: Loss = 1.5460, recLoss = 0.0658, clLoss = 1.4801, diLoss = 0.0019, CKDLoss = 0.0106  
2024-07-12 09:39:02.861607: Epoch 6/40, Test: Recall = 0.3368, NDCG = 0.1890  

2024-07-12 09:39:03.613608: 
2024-07-12 09:39:03.613608: Start to re-build kg
2024-07-12 09:39:07.602612: KG built!
2024-07-12 09:39:07.835613: Epoch 7/40, Train: Loss = 1.5379, recLoss = 0.0594, clLoss = 1.4785, diLoss = 0.0018, CKDLoss = 0.0205  
2024-07-12 09:39:07.985613: Epoch 7/40, Test: Recall = 0.3406, NDCG = 0.1911  

2024-07-12 09:39:08.722614: 
2024-07-12 09:39:08.722614: Start to re-build kg
2024-07-12 09:39:13.388619: KG built!
2024-07-12 09:39:13.962620: Epoch 8/40, Train: Loss = 1.5313, recLoss = 0.0541, clLoss = 1.4771, diLoss = 0.0022, CKDLoss = 0.0725  
2024-07-12 09:39:14.331620: Epoch 8/40, Test: Recall = 0.3430, NDCG = 0.1920  

2024-07-12 09:39:15.112622: 
2024-07-12 09:39:15.112622: Start to re-build kg
2024-07-12 09:39:20.736628: KG built!
2024-07-12 09:39:21.314629: Epoch 9/40, Train: Loss = 1.5269, recLoss = 0.0506, clLoss = 1.4763, diLoss = 0.0017, CKDLoss = 0.0910  
2024-07-12 09:39:21.526629: Epoch 9/40, Test: Recall = 0.3470, NDCG = 0.1954  

2024-07-12 09:39:22.198630: 
2024-07-12 09:39:22.198630: Start to re-build kg
2024-07-12 09:39:27.007636: KG built!
2024-07-12 09:39:27.450636: Epoch 10/40, Train: Loss = 1.5230, recLoss = 0.0480, clLoss = 1.4750, diLoss = 0.0021, CKDLoss = 0.1353  
2024-07-12 09:39:27.744637: Epoch 10/40, Test: Recall = 0.3445, NDCG = 0.1957  

2024-07-12 09:39:28.466638: 
2024-07-12 09:39:28.466638: Start to re-build kg
2024-07-12 09:39:33.712644: KG built!
2024-07-12 09:39:34.292645: Epoch 11/40, Train: Loss = 1.5171, recLoss = 0.0430, clLoss = 1.4740, diLoss = 0.0013, CKDLoss = 0.0502  
2024-07-12 09:39:34.702645: Epoch 11/40, Test: Recall = 0.3489, NDCG = 0.1980  

2024-07-12 09:39:35.465647: 
2024-07-12 09:39:35.465647: Start to re-build kg
2024-07-12 09:39:38.146650: KG built!
2024-07-12 09:39:38.538650: Epoch 12/40, Train: Loss = 1.5153, recLoss = 0.0420, clLoss = 1.4732, diLoss = 0.0009, CKDLoss = 0.0272  
2024-07-12 09:39:38.815650: Epoch 12/40, Test: Recall = 0.3505, NDCG = 0.1992  

2024-07-12 09:39:39.474651: 
2024-07-12 09:39:39.474651: Start to re-build kg
2024-07-12 09:39:44.643161: KG built!
2024-07-12 09:39:45.222162: Epoch 13/40, Train: Loss = 1.5110, recLoss = 0.0388, clLoss = 1.4722, diLoss = 0.0007, CKDLoss = 0.0161  
2024-07-12 09:39:45.575162: Epoch 13/40, Test: Recall = 0.3519, NDCG = 0.2004  

2024-07-12 09:39:46.316164: 
2024-07-12 09:39:46.316164: Start to re-build kg
2024-07-12 09:39:51.134169: KG built!
2024-07-12 09:39:51.499170: Epoch 14/40, Train: Loss = 1.5087, recLoss = 0.0370, clLoss = 1.4717, diLoss = 0.0007, CKDLoss = 0.0262  
2024-07-12 09:39:51.715170: Epoch 14/40, Test: Recall = 0.3543, NDCG = 0.2022  

2024-07-12 09:39:52.360171: 
2024-07-12 09:39:52.360171: Start to re-build kg
2024-07-12 09:39:57.553177: KG built!
2024-07-12 09:39:58.127178: Epoch 15/40, Train: Loss = 1.5057, recLoss = 0.0343, clLoss = 1.4713, diLoss = 0.0014, CKDLoss = 0.0109  
2024-07-12 09:39:58.491179: Epoch 15/40, Test: Recall = 0.3577, NDCG = 0.2048  

2024-07-12 09:39:59.246179: 
2024-07-12 09:39:59.246179: Start to re-build kg
2024-07-12 09:40:05.003187: KG built!
2024-07-12 09:40:05.588187: Epoch 16/40, Train: Loss = 1.5042, recLoss = 0.0334, clLoss = 1.4706, diLoss = 0.0011, CKDLoss = 0.0060  
2024-07-12 09:40:05.912187: Epoch 16/40, Test: Recall = 0.3582, NDCG = 0.2051  

2024-07-12 09:40:06.583188: 
2024-07-12 09:40:06.583188: Start to re-build kg
2024-07-12 09:40:11.156194: KG built!
2024-07-12 09:40:11.614195: Epoch 17/40, Train: Loss = 1.5039, recLoss = 0.0338, clLoss = 1.4700, diLoss = 0.0023, CKDLoss = 0.0029  
2024-07-12 09:40:11.848195: Epoch 17/40, Test: Recall = 0.3608, NDCG = 0.2064  

2024-07-12 09:40:12.554196: 
2024-07-12 09:40:12.554196: Start to re-build kg
2024-07-12 09:40:18.111203: KG built!
2024-07-12 09:40:18.697203: Epoch 18/40, Train: Loss = 1.5017, recLoss = 0.0323, clLoss = 1.4693, diLoss = 0.0011, CKDLoss = 0.0020  
2024-07-12 09:40:19.008204: Epoch 18/40, Test: Recall = 0.3603, NDCG = 0.2070  

2024-07-12 09:40:19.786204: 
2024-07-12 09:40:19.786204: Start to re-build kg
2024-07-12 09:40:22.335207: KG built!
2024-07-12 09:40:22.710208: Epoch 19/40, Train: Loss = 1.4980, recLoss = 0.0290, clLoss = 1.4689, diLoss = 0.0412, CKDLoss = 0.0033  
2024-07-12 09:40:22.977208: Epoch 19/40, Test: Recall = 0.3621, NDCG = 0.2076  

2024-07-12 09:40:23.767210: 
2024-07-12 09:40:23.767210: Start to re-build kg
2024-07-12 09:40:28.857215: KG built!
2024-07-12 09:40:29.443216: Epoch 20/40, Train: Loss = 1.4960, recLoss = 0.0273, clLoss = 1.4686, diLoss = 0.0032, CKDLoss = 0.0133  
2024-07-12 09:40:29.851217: Epoch 20/40, Test: Recall = 0.3646, NDCG = 0.2097  

2024-07-12 09:40:30.581218: 
2024-07-12 09:40:30.581218: Start to re-build kg
2024-07-12 09:40:34.961223: KG built!
2024-07-12 09:40:35.327223: Epoch 21/40, Train: Loss = 1.4956, recLoss = 0.0275, clLoss = 1.4680, diLoss = 0.0313, CKDLoss = 0.0036  
2024-07-12 09:40:35.476223: Epoch 21/40, Test: Recall = 0.3639, NDCG = 0.2100  

2024-07-12 09:40:36.158225: 
2024-07-12 09:40:36.158225: Start to re-build kg
2024-07-12 09:40:40.672230: KG built!
2024-07-12 09:40:41.226231: Epoch 22/40, Train: Loss = 1.4933, recLoss = 0.0254, clLoss = 1.4678, diLoss = 0.0069, CKDLoss = 0.0028  
2024-07-12 09:40:41.547231: Epoch 22/40, Test: Recall = 0.3664, NDCG = 0.2114  

2024-07-12 09:40:42.290232: 
2024-07-12 09:40:42.290232: Start to re-build kg
2024-07-12 09:40:47.383743: KG built!
2024-07-12 09:40:47.967743: Epoch 23/40, Train: Loss = 1.4912, recLoss = 0.0236, clLoss = 1.4675, diLoss = 0.0044, CKDLoss = 0.0012  
2024-07-12 09:40:48.277743: Epoch 23/40, Test: Recall = 0.3676, NDCG = 0.2126  

2024-07-12 09:40:49.032745: 
2024-07-12 09:40:49.032745: Start to re-build kg
2024-07-12 09:40:51.778748: KG built!
2024-07-12 09:40:52.228749: Epoch 24/40, Train: Loss = 1.4905, recLoss = 0.0233, clLoss = 1.4670, diLoss = 0.0059, CKDLoss = 0.0009  
2024-07-12 09:40:52.529749: Epoch 24/40, Test: Recall = 0.3692, NDCG = 0.2136  

2024-07-12 09:40:53.217750: 
2024-07-12 09:40:53.217750: Start to re-build kg
2024-07-12 09:40:58.634756: KG built!
2024-07-12 09:40:59.210757: Epoch 25/40, Train: Loss = 1.4892, recLoss = 0.0224, clLoss = 1.4667, diLoss = 0.0028, CKDLoss = 0.0013  
2024-07-12 09:40:59.526757: Epoch 25/40, Test: Recall = 0.3693, NDCG = 0.2140  

2024-07-12 09:41:00.289759: 
2024-07-12 09:41:00.289759: Start to re-build kg
2024-07-12 09:41:04.195763: KG built!
2024-07-12 09:41:04.501764: Epoch 26/40, Train: Loss = 1.4877, recLoss = 0.0213, clLoss = 1.4663, diLoss = 0.0015, CKDLoss = 0.0011  
2024-07-12 09:41:04.702764: Epoch 26/40, Test: Recall = 0.3708, NDCG = 0.2150  

2024-07-12 09:41:05.376765: 
2024-07-12 09:41:05.376765: Start to re-build kg
2024-07-12 09:41:10.601275: KG built!
2024-07-12 09:41:11.162276: Epoch 27/40, Train: Loss = 1.4872, recLoss = 0.0210, clLoss = 1.4661, diLoss = 0.0017, CKDLoss = 0.0008  
2024-07-12 09:41:11.484277: Epoch 27/40, Test: Recall = 0.3726, NDCG = 0.2161  

2024-07-12 09:41:12.220277: 
2024-07-12 09:41:12.220277: Start to re-build kg
2024-07-12 09:41:17.544788: KG built!
2024-07-12 09:41:17.891788: Epoch 28/40, Train: Loss = 1.4855, recLoss = 0.0196, clLoss = 1.4658, diLoss = 0.0008, CKDLoss = 0.0010  
2024-07-12 09:41:18.033788: Epoch 28/40, Test: Recall = 0.3748, NDCG = 0.2179  

2024-07-12 09:41:18.660789: 
2024-07-12 09:41:18.660789: Start to re-build kg
2024-07-12 09:41:20.516791: KG built!
2024-07-12 09:41:20.824791: Epoch 29/40, Train: Loss = 1.4862, recLoss = 0.0204, clLoss = 1.4657, diLoss = 0.0007, CKDLoss = 0.0012  
2024-07-12 09:41:20.969791: Epoch 29/40, Test: Recall = 0.3761, NDCG = 0.2190  

2024-07-12 09:41:21.610792: 
2024-07-12 09:41:21.610792: Start to re-build kg
2024-07-12 09:41:23.459298: KG built!
2024-07-12 09:41:23.779298: Epoch 30/40, Train: Loss = 1.4840, recLoss = 0.0186, clLoss = 1.4653, diLoss = 0.0006, CKDLoss = 0.0009  
2024-07-12 09:41:23.918298: Epoch 30/40, Test: Recall = 0.3731, NDCG = 0.2179  

2024-07-12 09:41:24.560299: 
2024-07-12 09:41:24.560299: Start to re-build kg
2024-07-12 09:41:26.481804: KG built!
2024-07-12 09:41:26.814804: Epoch 31/40, Train: Loss = 1.4825, recLoss = 0.0173, clLoss = 1.4651, diLoss = 0.0007, CKDLoss = 0.0013  
2024-07-12 09:41:26.958805: Epoch 31/40, Test: Recall = 0.3738, NDCG = 0.2183  

2024-07-12 09:41:27.580806: 
2024-07-12 09:41:27.580806: Start to re-build kg
2024-07-12 09:41:29.427808: KG built!
2024-07-12 09:41:29.751808: Epoch 32/40, Train: Loss = 1.4837, recLoss = 0.0188, clLoss = 1.4648, diLoss = 0.0006, CKDLoss = 0.0032  
2024-07-12 09:41:29.896808: Epoch 32/40, Test: Recall = 0.3744, NDCG = 0.2191  

2024-07-12 09:41:30.509809: 
2024-07-12 09:41:30.509809: Start to re-build kg
2024-07-12 09:41:32.341812: KG built!
2024-07-12 09:41:32.667812: Epoch 33/40, Train: Loss = 1.4820, recLoss = 0.0173, clLoss = 1.4646, diLoss = 0.0009, CKDLoss = 0.0179  
2024-07-12 09:41:32.812812: Epoch 33/40, Test: Recall = 0.3806, NDCG = 0.2206  

2024-07-12 09:41:33.458813: 
2024-07-12 09:41:33.458813: Start to re-build kg
2024-07-12 09:41:35.345815: KG built!
2024-07-12 09:41:35.673319: Epoch 34/40, Train: Loss = 1.4809, recLoss = 0.0163, clLoss = 1.4645, diLoss = 0.0006, CKDLoss = 0.0181  
2024-07-12 09:41:35.812319: Epoch 34/40, Test: Recall = 0.3781, NDCG = 0.2207  

2024-07-12 09:41:36.446320: 
2024-07-12 09:41:36.446320: Start to re-build kg
2024-07-12 09:41:38.333322: KG built!
2024-07-12 09:41:38.667323: Epoch 35/40, Train: Loss = 1.4805, recLoss = 0.0161, clLoss = 1.4642, diLoss = 0.0005, CKDLoss = 0.0421  
2024-07-12 09:41:38.808323: Epoch 35/40, Test: Recall = 0.3766, NDCG = 0.2205  

2024-07-12 09:41:39.453323: 
2024-07-12 09:41:39.453323: Start to re-build kg
2024-07-12 09:41:41.354326: KG built!
2024-07-12 09:41:41.703326: Epoch 36/40, Train: Loss = 1.4797, recLoss = 0.0155, clLoss = 1.4640, diLoss = 0.0005, CKDLoss = 0.0366  
2024-07-12 09:41:41.844327: Epoch 36/40, Test: Recall = 0.3741, NDCG = 0.2204  

2024-07-12 09:41:42.470327: 
2024-07-12 09:41:42.470327: Start to re-build kg
2024-07-12 09:41:44.381836: KG built!
2024-07-12 09:41:44.746837: Epoch 37/40, Train: Loss = 1.4796, recLoss = 0.0156, clLoss = 1.4639, diLoss = 0.0006, CKDLoss = 0.0739  
2024-07-12 09:41:44.890837: Epoch 37/40, Test: Recall = 0.3747, NDCG = 0.2213  

2024-07-12 09:41:45.521838: 
2024-07-12 09:41:45.521838: Start to re-build kg
2024-07-12 09:41:47.362840: KG built!
2024-07-12 09:41:47.691841: Epoch 38/40, Train: Loss = 1.4793, recLoss = 0.0153, clLoss = 1.4638, diLoss = 0.0019, CKDLoss = 0.2232  
2024-07-12 09:41:47.834840: Epoch 38/40, Test: Recall = 0.3766, NDCG = 0.2210  

2024-07-12 09:41:48.450841: 
2024-07-12 09:41:48.450841: Start to re-build kg
2024-07-12 09:41:50.326843: KG built!
2024-07-12 09:41:50.663844: Epoch 39/40, Train: Loss = 1.4783, recLoss = 0.0146, clLoss = 1.4636, diLoss = 0.0011, CKDLoss = 0.3338  
2024-07-12 09:41:50.802844: Epoch 39/40, Test: Recall = 0.3776, NDCG = 0.2216  

Best epoch :  33  , Recall :  0.38058769513314966  , NDCG :  0.22058920558027956

进程已结束,退出代码0