Begin to load knowledge graph triples ...
100%|##########| 297058/297058 [00:00<00:00, 379869.30it/s]
kg shape:  (49545, 49545)
number of edges in KG:  293856
2024-06-21 13:15:31.631688: Load Data
USER 100000 ITEM 30577
NUM OF INTERACTIONS 2035114
2024-06-21 13:15:33.437690: Model Prepared
2024-06-21 13:15:33.437690: Model Initialized
2024-06-21 13:15:55.628718: 
2024-06-21 13:15:55.628718: Start to re-build kg
2024-06-21 13:16:20.581748: KG built!
2024-06-21 13:19:04.036948: Epoch 0/40, Train: Loss = 19.9717, recLoss = 0.3151, clLoss = 19.6529, diLoss = 0.0002, CKDLoss = 0.0000  
2024-06-21 13:19:25.480974: Epoch 0/40, Test: Recall = 0.0281, NDCG = 0.0183  

2024-06-21 13:19:47.354001: 
2024-06-21 13:19:47.354001: Start to re-build kg
2024-06-21 13:20:12.205031: KG built!
2024-06-21 13:22:55.701231: Epoch 1/40, Train: Loss = 19.7830, recLoss = 0.1751, clLoss = 19.5972, diLoss = 0.0004, CKDLoss = 165.1450  
2024-06-21 13:23:18.102258: Epoch 1/40, Test: Recall = 0.0351, NDCG = 0.0227  

2024-06-21 13:23:40.001285: 
2024-06-21 13:23:40.001285: Start to re-build kg
2024-06-21 13:24:05.724317: KG built!
2024-06-21 13:26:49.128517: Epoch 2/40, Train: Loss = 19.7320, recLoss = 0.1344, clLoss = 19.5810, diLoss = 0.0007, CKDLoss = 407.3165  
2024-06-21 13:27:10.734543: Epoch 2/40, Test: Recall = 0.0418, NDCG = 0.0269  

2024-06-21 13:27:32.782570: 
2024-06-21 13:27:32.782570: Start to re-build kg
2024-06-21 13:27:57.999601: KG built!
2024-06-21 13:30:41.508801: Epoch 3/40, Train: Loss = 19.7040, recLoss = 0.1124, clLoss = 19.5702, diLoss = 0.0009, CKDLoss = 300.1201  
2024-06-21 13:31:02.722827: Epoch 3/40, Test: Recall = 0.0468, NDCG = 0.0304  

2024-06-21 13:31:24.566854: 
2024-06-21 13:31:24.566854: Start to re-build kg
2024-06-21 13:31:49.684884: KG built!
2024-06-21 13:34:33.359085: Epoch 4/40, Train: Loss = 19.6860, recLoss = 0.0982, clLoss = 19.5623, diLoss = 0.0009, CKDLoss = 285.3512  
2024-06-21 13:34:54.769111: Epoch 4/40, Test: Recall = 0.0509, NDCG = 0.0331  

2024-06-21 13:35:16.640137: 
2024-06-21 13:35:16.640137: Start to re-build kg
2024-06-21 13:35:41.945168: KG built!
2024-06-21 13:38:25.475369: Epoch 5/40, Train: Loss = 19.6732, recLoss = 0.0878, clLoss = 19.5566, diLoss = 0.0008, CKDLoss = 314.1989  
2024-06-21 13:38:47.423395: Epoch 5/40, Test: Recall = 0.0543, NDCG = 0.0353  

2024-06-21 13:39:09.413423: 
2024-06-21 13:39:09.413423: Start to re-build kg
2024-06-21 13:39:34.668453: KG built!
2024-06-21 13:42:18.232653: Epoch 6/40, Train: Loss = 19.6640, recLoss = 0.0804, clLoss = 19.5521, diLoss = 0.0010, CKDLoss = 1032.8797  
2024-06-21 13:42:40.565680: Epoch 6/40, Test: Recall = 0.0573, NDCG = 0.0373  

2024-06-21 13:43:02.577707: 
2024-06-21 13:43:02.577707: Start to re-build kg
2024-06-21 13:43:27.625738: KG built!
2024-06-21 13:46:11.182938: Epoch 7/40, Train: Loss = 19.6568, recLoss = 0.0744, clLoss = 19.5486, diLoss = 0.0015, CKDLoss = 2144.1698  
2024-06-21 13:46:33.339966: Epoch 7/40, Test: Recall = 0.0594, NDCG = 0.0383  

2024-06-21 13:46:55.351992: 
2024-06-21 13:46:55.351992: Start to re-build kg
2024-06-21 13:47:20.133022: KG built!
2024-06-21 13:50:03.359222: Epoch 8/40, Train: Loss = 19.6517, recLoss = 0.0702, clLoss = 19.5458, diLoss = 0.0015, CKDLoss = 1570.3504  
2024-06-21 13:50:25.422250: Epoch 8/40, Test: Recall = 0.0596, NDCG = 0.0386  

2024-06-21 13:50:47.260276: 
2024-06-21 13:50:47.260276: Start to re-build kg
2024-06-21 13:51:12.147306: KG built!
2024-06-21 13:53:55.607506: Epoch 9/40, Train: Loss = 19.6469, recLoss = 0.0662, clLoss = 19.5435, diLoss = 0.0014, CKDLoss = 964.2306  
2024-06-21 13:54:17.395533: Epoch 9/40, Test: Recall = 0.0624, NDCG = 0.0408  

2024-06-21 13:54:39.364560: 
2024-06-21 13:54:39.364560: Start to re-build kg
2024-06-21 13:55:04.396590: KG built!
2024-06-21 13:57:47.871790: Epoch 10/40, Train: Loss = 19.6435, recLoss = 0.0634, clLoss = 19.5415, diLoss = 0.0013, CKDLoss = 538.4868  
2024-06-21 13:58:09.615817: Epoch 10/40, Test: Recall = 0.0619, NDCG = 0.0400  

2024-06-21 13:58:31.568844: 
2024-06-21 13:58:31.568844: Start to re-build kg
2024-06-21 13:58:56.657874: KG built!
2024-06-21 14:01:40.196075: Epoch 11/40, Train: Loss = 19.6409, recLoss = 0.0613, clLoss = 19.5400, diLoss = 0.0015, CKDLoss = 351.4455  
2024-06-21 14:02:01.642101: Epoch 11/40, Test: Recall = 0.0628, NDCG = 0.0404  

2024-06-21 14:02:23.582128: 
2024-06-21 14:02:23.582128: Start to re-build kg
2024-06-21 14:02:48.700158: KG built!
2024-06-21 14:05:32.089359: Epoch 12/40, Train: Loss = 19.6383, recLoss = 0.0590, clLoss = 19.5386, diLoss = 0.0014, CKDLoss = 279.5185  
2024-06-21 14:05:53.519385: Epoch 12/40, Test: Recall = 0.0625, NDCG = 0.0408  

2024-06-21 14:06:15.399411: 
2024-06-21 14:06:15.399411: Start to re-build kg
2024-06-21 14:06:40.568442: KG built!
2024-06-21 14:09:24.203642: Epoch 13/40, Train: Loss = 19.6361, recLoss = 0.0571, clLoss = 19.5375, diLoss = 0.0012, CKDLoss = 168.7095  
2024-06-21 14:09:46.635670: Epoch 13/40, Test: Recall = 0.0636, NDCG = 0.0413  

2024-06-21 14:10:08.522697: 
2024-06-21 14:10:08.522697: Start to re-build kg
2024-06-21 14:10:33.495727: KG built!
2024-06-21 14:13:16.845927: Epoch 14/40, Train: Loss = 19.6344, recLoss = 0.0557, clLoss = 19.5365, diLoss = 0.0013, CKDLoss = 196.8868  
2024-06-21 14:13:38.968954: Epoch 14/40, Test: Recall = 0.0628, NDCG = 0.0408  

2024-06-21 14:14:00.805981: 
2024-06-21 14:14:00.805981: Start to re-build kg
2024-06-21 14:14:26.088011: KG built!
2024-06-21 14:17:09.531212: Epoch 15/40, Train: Loss = 19.6330, recLoss = 0.0546, clLoss = 19.5356, diLoss = 0.0012, CKDLoss = 182.7715  
2024-06-21 14:17:31.382239: Epoch 15/40, Test: Recall = 0.0610, NDCG = 0.0390  

2024-06-21 14:17:53.407265: 
2024-06-21 14:17:53.407265: Start to re-build kg
2024-06-21 14:18:18.397296: KG built!
2024-06-21 14:21:01.872496: Epoch 16/40, Train: Loss = 19.6318, recLoss = 0.0536, clLoss = 19.5350, diLoss = 0.0013, CKDLoss = 204.8236  
2024-06-21 14:21:23.753522: Epoch 16/40, Test: Recall = 0.0615, NDCG = 0.0393  

2024-06-21 14:21:45.725550: 
2024-06-21 14:21:45.725550: Start to re-build kg
2024-06-21 14:22:11.050581: KG built!
2024-06-21 14:24:54.565780: Epoch 17/40, Train: Loss = 19.6306, recLoss = 0.0526, clLoss = 19.5343, diLoss = 0.0013, CKDLoss = 311.4253  
2024-06-21 14:25:16.361807: Epoch 17/40, Test: Recall = 0.0629, NDCG = 0.0409  

2024-06-21 14:25:38.168834: 
2024-06-21 14:25:38.168834: Start to re-build kg
2024-06-21 14:26:03.283864: KG built!
2024-06-21 14:28:46.800064: Epoch 18/40, Train: Loss = 19.6294, recLoss = 0.0514, clLoss = 19.5337, diLoss = 0.0012, CKDLoss = 290.4528  
2024-06-21 14:29:08.729091: Epoch 18/40, Test: Recall = 0.0620, NDCG = 0.0399  

2024-06-21 14:29:30.714119: 
2024-06-21 14:29:30.714119: Start to re-build kg
2024-06-21 14:29:55.831149: KG built!
2024-06-21 14:32:39.701852: Epoch 19/40, Train: Loss = 19.6284, recLoss = 0.0506, clLoss = 19.5332, diLoss = 0.0012, CKDLoss = 258.8388  
2024-06-21 14:33:00.760878: Epoch 19/40, Test: Recall = 0.0646, NDCG = 0.0419  

2024-06-21 14:33:23.235905: 
2024-06-21 14:33:23.235905: Start to re-build kg
2024-06-21 14:33:48.358448: KG built!
2024-06-21 14:36:31.858648: Epoch 20/40, Train: Loss = 19.6281, recLoss = 0.0505, clLoss = 19.5327, diLoss = 0.0013, CKDLoss = 369.3029  
2024-06-21 14:36:53.581674: Epoch 20/40, Test: Recall = 0.0630, NDCG = 0.0407  

2024-06-21 14:37:15.574701: 
2024-06-21 14:37:15.574701: Start to re-build kg
2024-06-21 14:37:40.744732: KG built!
2024-06-21 14:40:24.122932: Epoch 21/40, Train: Loss = 19.6272, recLoss = 0.0497, clLoss = 19.5323, diLoss = 0.0012, CKDLoss = 206.5181  
2024-06-21 14:40:45.889958: Epoch 21/40, Test: Recall = 0.0616, NDCG = 0.0391  

2024-06-21 14:41:08.059986: 
2024-06-21 14:41:08.059986: Start to re-build kg
2024-06-21 14:41:33.253017: KG built!
2024-06-21 14:44:16.515216: Epoch 22/40, Train: Loss = 19.6264, recLoss = 0.0489, clLoss = 19.5319, diLoss = 0.0014, CKDLoss = 167.9433  
2024-06-21 14:44:38.556243: Epoch 22/40, Test: Recall = 0.0624, NDCG = 0.0408  

2024-06-21 14:45:00.438270: 
2024-06-21 14:45:00.438270: Start to re-build kg
2024-06-21 14:45:25.372300: KG built!
2024-06-21 14:48:09.054500: Epoch 23/40, Train: Loss = 19.6263, recLoss = 0.0489, clLoss = 19.5316, diLoss = 0.0013, CKDLoss = 104.4056  
2024-06-21 14:48:31.225528: Epoch 23/40, Test: Recall = 0.0627, NDCG = 0.0406  

2024-06-21 14:48:53.168555: 
2024-06-21 14:48:53.168555: Start to re-build kg
2024-06-21 14:49:18.384585: KG built!
2024-06-21 14:52:01.886785: Epoch 24/40, Train: Loss = 19.6254, recLoss = 0.0480, clLoss = 19.5313, diLoss = 0.0014, CKDLoss = 66.1061  
2024-06-21 14:52:23.533812: Epoch 24/40, Test: Recall = 0.0628, NDCG = 0.0408  

2024-06-21 14:52:45.428839: 
2024-06-21 14:52:45.428839: Start to re-build kg
2024-06-21 14:53:10.883870: KG built!
2024-06-21 14:55:54.323071: Epoch 25/40, Train: Loss = 19.6254, recLoss = 0.0481, clLoss = 19.5310, diLoss = 0.0014, CKDLoss = 68.3815  
2024-06-21 14:56:15.934096: Epoch 25/40, Test: Recall = 0.0631, NDCG = 0.0414  

2024-06-21 14:56:37.860123: 
2024-06-21 14:56:37.860123: Start to re-build kg
2024-06-21 14:57:02.908154: KG built!
2024-06-21 14:59:46.397353: Epoch 26/40, Train: Loss = 19.6248, recLoss = 0.0474, clLoss = 19.5309, diLoss = 0.0013, CKDLoss = 74.3888  
2024-06-21 15:00:08.206380: Epoch 26/40, Test: Recall = 0.0626, NDCG = 0.0401  

2024-06-21 15:00:30.006407: 
2024-06-21 15:00:30.006407: Start to re-build kg
2024-06-21 15:00:55.236438: KG built!
2024-06-21 15:03:38.723638: Epoch 27/40, Train: Loss = 19.6243, recLoss = 0.0469, clLoss = 19.5306, diLoss = 0.0013, CKDLoss = 61.2614  
2024-06-21 15:04:00.287664: Epoch 27/40, Test: Recall = 0.0630, NDCG = 0.0406  

2024-06-21 15:04:22.331691: 
2024-06-21 15:04:22.331691: Start to re-build kg
2024-06-21 15:04:47.218722: KG built!
2024-06-21 15:07:30.797922: Epoch 28/40, Train: Loss = 19.6241, recLoss = 0.0468, clLoss = 19.5304, diLoss = 0.0012, CKDLoss = 40.8706  
2024-06-21 15:07:52.810949: Epoch 28/40, Test: Recall = 0.0623, NDCG = 0.0409  

2024-06-21 15:08:14.626976: 
2024-06-21 15:08:14.626976: Start to re-build kg
2024-06-21 15:08:39.880006: KG built!
2024-06-21 15:11:23.154206: Epoch 29/40, Train: Loss = 19.6238, recLoss = 0.0466, clLoss = 19.5303, diLoss = 0.0011, CKDLoss = 35.6887  
2024-06-21 15:11:45.851234: Epoch 29/40, Test: Recall = 0.0622, NDCG = 0.0402  

2024-06-21 15:12:07.856261: 
2024-06-21 15:12:07.856261: Start to re-build kg
2024-06-21 15:12:33.254292: KG built!
2024-06-21 15:15:16.726492: Epoch 30/40, Train: Loss = 19.6236, recLoss = 0.0464, clLoss = 19.5301, diLoss = 0.0011, CKDLoss = 39.0566  
2024-06-21 15:15:38.726519: Epoch 30/40, Test: Recall = 0.0614, NDCG = 0.0402  

2024-06-21 15:16:00.687546: 
2024-06-21 15:16:00.687546: Start to re-build kg
2024-06-21 15:16:25.328575: KG built!
2024-06-21 15:19:08.871776: Epoch 31/40, Train: Loss = 19.6233, recLoss = 0.0460, clLoss = 19.5299, diLoss = 0.0010, CKDLoss = 46.6885  
2024-06-21 15:19:30.852802: Epoch 31/40, Test: Recall = 0.0623, NDCG = 0.0405  

2024-06-21 15:19:52.793830: 
2024-06-21 15:19:52.793830: Start to re-build kg
2024-06-21 15:20:17.806860: KG built!
2024-06-21 15:23:01.256060: Epoch 32/40, Train: Loss = 19.6230, recLoss = 0.0458, clLoss = 19.5298, diLoss = 0.0010, CKDLoss = 49.7202  
2024-06-21 15:23:23.001086: Epoch 32/40, Test: Recall = 0.0602, NDCG = 0.0385  

2024-06-21 15:23:45.171114: 
2024-06-21 15:23:45.171114: Start to re-build kg
2024-06-21 15:24:10.292144: KG built!
2024-06-21 15:26:53.930345: Epoch 33/40, Train: Loss = 19.6228, recLoss = 0.0456, clLoss = 19.5296, diLoss = 0.0011, CKDLoss = 46.4341  
2024-06-21 15:27:16.055372: Epoch 33/40, Test: Recall = 0.0605, NDCG = 0.0397  

2024-06-21 15:27:37.930398: 
2024-06-21 15:27:37.930398: Start to re-build kg
2024-06-21 15:28:02.955429: KG built!
2024-06-21 15:30:46.591629: Epoch 34/40, Train: Loss = 19.6226, recLoss = 0.0454, clLoss = 19.5295, diLoss = 0.0012, CKDLoss = 55.9151  
2024-06-21 15:31:08.391656: Epoch 34/40, Test: Recall = 0.0617, NDCG = 0.0399  

2024-06-21 15:31:30.349683: 
2024-06-21 15:31:30.349683: Start to re-build kg
2024-06-21 15:31:55.532714: KG built!
2024-06-21 15:34:39.023913: Epoch 35/40, Train: Loss = 19.6225, recLoss = 0.0453, clLoss = 19.5294, diLoss = 0.0011, CKDLoss = 74.3301  
2024-06-21 15:35:00.785940: Epoch 35/40, Test: Recall = 0.0609, NDCG = 0.0397  

2024-06-21 15:35:22.795967: 
2024-06-21 15:35:22.795967: Start to re-build kg
2024-06-21 15:35:47.770998: KG built!
2024-06-21 15:38:31.280198: Epoch 36/40, Train: Loss = 19.6226, recLoss = 0.0453, clLoss = 19.5293, diLoss = 0.0011, CKDLoss = 76.6334  
2024-06-21 15:38:52.859225: Epoch 36/40, Test: Recall = 0.0586, NDCG = 0.0377  

2024-06-21 15:39:14.833251: 
2024-06-21 15:39:14.833251: Start to re-build kg
2024-06-21 15:39:39.554281: KG built!
2024-06-21 15:42:23.292482: Epoch 37/40, Train: Loss = 19.6220, recLoss = 0.0448, clLoss = 19.5292, diLoss = 0.0013, CKDLoss = 93.6524  
2024-06-21 15:42:45.206508: Epoch 37/40, Test: Recall = 0.0589, NDCG = 0.0374  

2024-06-21 15:43:07.252536: 
2024-06-21 15:43:07.252536: Start to re-build kg
2024-06-21 15:43:32.514566: KG built!
2024-06-21 15:46:16.191766: Epoch 38/40, Train: Loss = 19.6218, recLoss = 0.0445, clLoss = 19.5291, diLoss = 0.0013, CKDLoss = 163.8010  
2024-06-21 15:46:37.749793: Epoch 38/40, Test: Recall = 0.0601, NDCG = 0.0385  

2024-06-21 15:46:59.624820: 
2024-06-21 15:46:59.624820: Start to re-build kg
2024-06-21 15:47:24.923851: KG built!
2024-06-21 15:50:08.435050: Epoch 39/40, Train: Loss = 19.6217, recLoss = 0.0445, clLoss = 19.5290, diLoss = 0.0015, CKDLoss = 122.6751  
2024-06-21 15:50:30.806078: Epoch 39/40, Test: Recall = 0.0593, NDCG = 0.0382  

Best epoch :  19  , Recall :  0.06461920870856092  , NDCG :  0.041886432856111225