Begin to load knowledge graph triples ...
100%|##########| 40390/40390 [00:00<00:00, 425160.97it/s]
kg shape:  (6729, 6729)
number of edges in KG:  38346
2024-07-19 11:46:30.274077: Load Data
USER 6036 ITEM 2347
NUM OF INTERACTIONS 301509
2024-07-19 11:46:30.923078: Model Prepared
2024-07-19 11:46:30.923078: Model Initialized
2024-07-19 11:46:32.470080: 
2024-07-19 11:46:32.470080: Start to re-build kg
2024-07-19 11:46:36.614085: KG built!
2024-07-19 11:46:46.137097: Epoch 0/40, Train: Loss = 0.4064, recLoss = 0.2998, clLoss = 0.1065, diLoss = 0.0024, CKDLoss = 0.0001  
2024-07-19 11:46:47.433098: Epoch 0/40, Test: Recall = 0.2219, NDCG = 0.2103  

2024-07-19 11:46:48.314099: 
2024-07-19 11:46:48.314099: Start to re-build kg
2024-07-19 11:46:52.983105: KG built!
2024-07-19 11:47:02.167116: Epoch 1/40, Train: Loss = 0.3039, recLoss = 0.2115, clLoss = 0.0921, diLoss = 0.0018, CKDLoss = 23.5400  
2024-07-19 11:47:03.515118: Epoch 1/40, Test: Recall = 0.2521, NDCG = 0.2391  

2024-07-19 11:47:04.385119: 
2024-07-19 11:47:04.385119: Start to re-build kg
2024-07-19 11:47:09.046124: KG built!
2024-07-19 11:47:18.245136: Epoch 2/40, Train: Loss = 0.2731, recLoss = 0.1917, clLoss = 0.0809, diLoss = 0.0035, CKDLoss = 44.1073  
2024-07-19 11:47:19.560137: Epoch 2/40, Test: Recall = 0.2686, NDCG = 0.2534  

2024-07-19 11:47:20.425139: 
2024-07-19 11:47:20.425139: Start to re-build kg
2024-07-19 11:47:24.174143: KG built!
2024-07-19 11:47:33.592155: Epoch 3/40, Train: Loss = 0.2539, recLoss = 0.1799, clLoss = 0.0734, diLoss = 0.0027, CKDLoss = 42.6668  
2024-07-19 11:47:35.008156: Epoch 3/40, Test: Recall = 0.2817, NDCG = 0.2649  

2024-07-19 11:47:35.889157: 
2024-07-19 11:47:35.889157: Start to re-build kg
2024-07-19 11:47:39.898162: KG built!
2024-07-19 11:47:49.043174: Epoch 4/40, Train: Loss = 0.2389, recLoss = 0.1712, clLoss = 0.0669, diLoss = 0.0032, CKDLoss = 21.9406  
2024-07-19 11:47:50.427175: Epoch 4/40, Test: Recall = 0.2875, NDCG = 0.2723  

2024-07-19 11:47:51.289176: 
2024-07-19 11:47:51.289176: Start to re-build kg
2024-07-19 11:47:55.598181: KG built!
2024-07-19 11:48:04.869193: Epoch 5/40, Train: Loss = 0.2249, recLoss = 0.1623, clLoss = 0.0617, diLoss = 0.0030, CKDLoss = 12.5666  
2024-07-19 11:48:06.171195: Epoch 5/40, Test: Recall = 0.2977, NDCG = 0.2802  

2024-07-19 11:48:07.044196: 
2024-07-19 11:48:07.044196: Start to re-build kg
2024-07-19 11:48:10.757200: KG built!
2024-07-19 11:48:20.042211: Epoch 6/40, Train: Loss = 0.2134, recLoss = 0.1554, clLoss = 0.0569, diLoss = 0.0032, CKDLoss = 12.6114  
2024-07-19 11:48:21.460213: Epoch 6/40, Test: Recall = 0.3059, NDCG = 0.2879  

2024-07-19 11:48:22.350214: 
2024-07-19 11:48:22.350214: Start to re-build kg
2024-07-19 11:48:25.909218: KG built!
2024-07-19 11:48:34.841229: Epoch 7/40, Train: Loss = 0.2044, recLoss = 0.1505, clLoss = 0.0526, diLoss = 0.0049, CKDLoss = 8.5828  
2024-07-19 11:48:36.202231: Epoch 7/40, Test: Recall = 0.3121, NDCG = 0.2933  

2024-07-19 11:48:37.090233: 
2024-07-19 11:48:37.090233: Start to re-build kg
2024-07-19 11:48:41.076238: KG built!
2024-07-19 11:48:50.171249: Epoch 8/40, Train: Loss = 0.1951, recLoss = 0.1448, clLoss = 0.0489, diLoss = 0.0025, CKDLoss = 5.3903  
2024-07-19 11:48:51.505250: Epoch 8/40, Test: Recall = 0.3162, NDCG = 0.2969  

2024-07-19 11:48:52.383251: 
2024-07-19 11:48:52.383251: Start to re-build kg
2024-07-19 11:48:56.076256: KG built!
2024-07-19 11:49:05.293267: Epoch 9/40, Train: Loss = 0.1871, recLoss = 0.1397, clLoss = 0.0457, diLoss = 0.0027, CKDLoss = 3.0112  
2024-07-19 11:49:06.668269: Epoch 9/40, Test: Recall = 0.3201, NDCG = 0.2997  

2024-07-19 11:49:07.534269: 
2024-07-19 11:49:07.534269: Start to re-build kg
2024-07-19 11:49:11.460274: KG built!
2024-07-19 11:49:20.799286: Epoch 10/40, Train: Loss = 0.1800, recLoss = 0.1355, clLoss = 0.0428, diLoss = 0.0024, CKDLoss = 1.3908  
2024-07-19 11:49:22.228288: Epoch 10/40, Test: Recall = 0.3229, NDCG = 0.3019  

2024-07-19 11:49:23.134288: 
2024-07-19 11:49:23.134288: Start to re-build kg
2024-07-19 11:49:26.743293: KG built!
2024-07-19 11:49:35.810304: Epoch 11/40, Train: Loss = 0.1727, recLoss = 0.1305, clLoss = 0.0403, diLoss = 0.0027, CKDLoss = 4.3946  
2024-07-19 11:49:37.152306: Epoch 11/40, Test: Recall = 0.3238, NDCG = 0.3037  

2024-07-19 11:49:38.021307: 
2024-07-19 11:49:38.021307: Start to re-build kg
2024-07-19 11:49:42.299312: KG built!
2024-07-19 11:49:51.243324: Epoch 12/40, Train: Loss = 0.1671, recLoss = 0.1270, clLoss = 0.0380, diLoss = 0.0021, CKDLoss = 2.6733  
2024-07-19 11:49:52.645324: Epoch 12/40, Test: Recall = 0.3253, NDCG = 0.3044  

2024-07-19 11:49:53.517326: 
2024-07-19 11:49:53.517326: Start to re-build kg
2024-07-19 11:49:57.407331: KG built!
2024-07-19 11:50:06.599342: Epoch 13/40, Train: Loss = 0.1618, recLoss = 0.1236, clLoss = 0.0360, diLoss = 0.0019, CKDLoss = 1.7754  
2024-07-19 11:50:07.843343: Epoch 13/40, Test: Recall = 0.3254, NDCG = 0.3051  

2024-07-19 11:50:08.726345: 
2024-07-19 11:50:08.726345: Start to re-build kg
2024-07-19 11:50:12.729350: KG built!
2024-07-19 11:50:22.025361: Epoch 14/40, Train: Loss = 0.1567, recLoss = 0.1201, clLoss = 0.0343, diLoss = 0.0021, CKDLoss = 6.1626  
2024-07-19 11:50:23.332362: Epoch 14/40, Test: Recall = 0.3260, NDCG = 0.3061  

2024-07-19 11:50:24.244364: 
2024-07-19 11:50:24.244364: Start to re-build kg
2024-07-19 11:50:27.940368: KG built!
2024-07-19 11:50:37.420379: Epoch 15/40, Train: Loss = 0.1512, recLoss = 0.1161, clLoss = 0.0326, diLoss = 0.0025, CKDLoss = 3.5186  
2024-07-19 11:50:38.594381: Epoch 15/40, Test: Recall = 0.3264, NDCG = 0.3059  

2024-07-19 11:50:39.475382: 
2024-07-19 11:50:39.475382: Start to re-build kg
2024-07-19 11:50:43.461387: KG built!
2024-07-19 11:50:52.861398: Epoch 16/40, Train: Loss = 0.1453, recLoss = 0.1114, clLoss = 0.0312, diLoss = 0.0032, CKDLoss = 11.9529  
2024-07-19 11:50:54.127400: Epoch 16/40, Test: Recall = 0.3269, NDCG = 0.3059  

2024-07-19 11:50:55.030401: 
2024-07-19 11:50:55.030401: Start to re-build kg
2024-07-19 11:50:59.091406: KG built!
2024-07-19 11:51:08.424417: Epoch 17/40, Train: Loss = 0.1427, recLoss = 0.1100, clLoss = 0.0299, diLoss = 0.0023, CKDLoss = 33.4825  
2024-07-19 11:51:09.602419: Epoch 17/40, Test: Recall = 0.3253, NDCG = 0.3044  

2024-07-19 11:51:10.470420: 
2024-07-19 11:51:10.470420: Start to re-build kg
2024-07-19 11:51:14.724425: KG built!
2024-07-19 11:51:24.080436: Epoch 18/40, Train: Loss = 0.1402, recLoss = 0.1086, clLoss = 0.0286, diLoss = 0.0031, CKDLoss = 107.4155  
2024-07-19 11:51:25.375942: Epoch 18/40, Test: Recall = 0.3232, NDCG = 0.3041  

2024-07-19 11:51:26.249943: 
2024-07-19 11:51:26.249943: Start to re-build kg
2024-07-19 11:51:30.273949: KG built!
2024-07-19 11:51:39.579960: Epoch 19/40, Train: Loss = 0.1362, recLoss = 0.1055, clLoss = 0.0275, diLoss = 0.0034, CKDLoss = 92.8819  
2024-07-19 11:51:40.918961: Epoch 19/40, Test: Recall = 0.3229, NDCG = 0.3036  

2024-07-19 11:51:41.824963: 
2024-07-19 11:51:41.824963: Start to re-build kg
2024-07-19 11:51:46.452968: KG built!
2024-07-19 11:51:55.404980: Epoch 20/40, Train: Loss = 0.1330, recLoss = 0.1032, clLoss = 0.0265, diLoss = 0.0023, CKDLoss = 154.9379  
2024-07-19 11:51:56.613981: Epoch 20/40, Test: Recall = 0.3217, NDCG = 0.3030  

2024-07-19 11:51:57.474982: 
2024-07-19 11:51:57.474982: Start to re-build kg
2024-07-19 11:52:02.197989: KG built!
2024-07-19 11:52:11.411999: Epoch 21/40, Train: Loss = 0.1294, recLoss = 0.1004, clLoss = 0.0255, diLoss = 0.0028, CKDLoss = 65.4882  
2024-07-19 11:52:12.776001: Epoch 21/40, Test: Recall = 0.3216, NDCG = 0.3024  

2024-07-19 11:52:13.708002: 
2024-07-19 11:52:13.708002: Start to re-build kg
2024-07-19 11:52:18.320007: KG built!
2024-07-19 11:52:27.276018: Epoch 22/40, Train: Loss = 0.1260, recLoss = 0.0977, clLoss = 0.0247, diLoss = 0.0028, CKDLoss = 74.9356  
2024-07-19 11:52:28.643020: Epoch 22/40, Test: Recall = 0.3214, NDCG = 0.3024  

2024-07-19 11:52:29.493021: 
2024-07-19 11:52:29.493021: Start to re-build kg
2024-07-19 11:52:33.624026: KG built!
2024-07-19 11:52:42.666037: Epoch 23/40, Train: Loss = 0.1240, recLoss = 0.0965, clLoss = 0.0238, diLoss = 0.0027, CKDLoss = 46.8453  
2024-07-19 11:52:43.993039: Epoch 23/40, Test: Recall = 0.3191, NDCG = 0.2999  

2024-07-19 11:52:44.860040: 
2024-07-19 11:52:44.860040: Start to re-build kg
2024-07-19 11:52:48.693044: KG built!
2024-07-19 11:52:57.804056: Epoch 24/40, Train: Loss = 0.1215, recLoss = 0.0945, clLoss = 0.0231, diLoss = 0.0023, CKDLoss = 30.5784  
2024-07-19 11:52:59.057057: Epoch 24/40, Test: Recall = 0.3192, NDCG = 0.2993  

2024-07-19 11:52:59.927058: 
2024-07-19 11:52:59.927058: Start to re-build kg
2024-07-19 11:53:04.132064: KG built!
2024-07-19 11:53:13.494075: Epoch 25/40, Train: Loss = 0.1182, recLoss = 0.0917, clLoss = 0.0225, diLoss = 0.0022, CKDLoss = 27.6531  
2024-07-19 11:53:14.824077: Epoch 25/40, Test: Recall = 0.3174, NDCG = 0.2977  

2024-07-19 11:53:15.712077: 
2024-07-19 11:53:15.712077: Start to re-build kg
2024-07-19 11:53:19.555082: KG built!
2024-07-19 11:53:28.814094: Epoch 26/40, Train: Loss = 0.1164, recLoss = 0.0904, clLoss = 0.0218, diLoss = 0.0035, CKDLoss = 13.8841  
2024-07-19 11:53:30.110095: Epoch 26/40, Test: Recall = 0.3145, NDCG = 0.2958  

2024-07-19 11:53:30.978097: 
2024-07-19 11:53:30.978097: Start to re-build kg
2024-07-19 11:53:35.058101: KG built!
2024-07-19 11:53:44.177113: Epoch 27/40, Train: Loss = 0.1137, recLoss = 0.0881, clLoss = 0.0213, diLoss = 0.0025, CKDLoss = 9.8385  
2024-07-19 11:53:45.487114: Epoch 27/40, Test: Recall = 0.3123, NDCG = 0.2931  

2024-07-19 11:53:46.369116: 
2024-07-19 11:53:46.369116: Start to re-build kg
2024-07-19 11:53:50.581121: KG built!
2024-07-19 11:53:59.705131: Epoch 28/40, Train: Loss = 0.1118, recLoss = 0.0865, clLoss = 0.0208, diLoss = 0.0021, CKDLoss = 4.6213  
2024-07-19 11:54:01.010133: Epoch 28/40, Test: Recall = 0.3103, NDCG = 0.2905  

2024-07-19 11:54:01.916134: 
2024-07-19 11:54:01.917134: Start to re-build kg
2024-07-19 11:54:05.968139: KG built!
2024-07-19 11:54:15.059150: Epoch 29/40, Train: Loss = 0.1103, recLoss = 0.0854, clLoss = 0.0203, diLoss = 0.0033, CKDLoss = 10.2234  
2024-07-19 11:54:16.359152: Epoch 29/40, Test: Recall = 0.3099, NDCG = 0.2901  

2024-07-19 11:54:17.250153: 
2024-07-19 11:54:17.250153: Start to re-build kg
2024-07-19 11:54:21.797158: KG built!
2024-07-19 11:54:31.015170: Epoch 30/40, Train: Loss = 0.1079, recLoss = 0.0834, clLoss = 0.0199, diLoss = 0.0024, CKDLoss = 10.5819  
2024-07-19 11:54:32.333171: Epoch 30/40, Test: Recall = 0.3101, NDCG = 0.2901  

2024-07-19 11:54:33.202172: 
2024-07-19 11:54:33.202172: Start to re-build kg
2024-07-19 11:54:37.451177: KG built!
2024-07-19 11:54:46.902189: Epoch 31/40, Train: Loss = 0.1069, recLoss = 0.0826, clLoss = 0.0195, diLoss = 0.0023, CKDLoss = 5.7180  
2024-07-19 11:54:48.236191: Epoch 31/40, Test: Recall = 0.3082, NDCG = 0.2891  

2024-07-19 11:54:49.098192: 
2024-07-19 11:54:49.098192: Start to re-build kg
2024-07-19 11:54:53.002197: KG built!
2024-07-19 11:55:02.169208: Epoch 32/40, Train: Loss = 0.1054, recLoss = 0.0814, clLoss = 0.0190, diLoss = 0.0020, CKDLoss = 6.6618  
2024-07-19 11:55:03.572210: Epoch 32/40, Test: Recall = 0.3063, NDCG = 0.2869  

2024-07-19 11:55:04.492212: 
2024-07-19 11:55:04.492212: Start to re-build kg
2024-07-19 11:55:09.429217: KG built!
2024-07-19 11:55:15.377224: Epoch 33/40, Train: Loss = 0.1032, recLoss = 0.0794, clLoss = 0.0187, diLoss = 0.0040, CKDLoss = 8.2561  
2024-07-19 11:55:15.931225: Epoch 33/40, Test: Recall = 0.3031, NDCG = 0.2846  

2024-07-19 11:55:16.720226: 
2024-07-19 11:55:16.720226: Start to re-build kg
2024-07-19 11:55:17.935227: KG built!
2024-07-19 11:55:23.564234: Epoch 34/40, Train: Loss = 0.1033, recLoss = 0.0798, clLoss = 0.0184, diLoss = 0.0035, CKDLoss = 8.8686  
2024-07-19 11:55:24.095234: Epoch 34/40, Test: Recall = 0.3014, NDCG = 0.2839  

2024-07-19 11:55:24.885235: 
2024-07-19 11:55:24.885235: Start to re-build kg
2024-07-19 11:55:26.101237: KG built!
2024-07-19 11:55:31.827244: Epoch 35/40, Train: Loss = 0.1011, recLoss = 0.0779, clLoss = 0.0179, diLoss = 0.0024, CKDLoss = 4.7961  
2024-07-19 11:55:32.364245: Epoch 35/40, Test: Recall = 0.3009, NDCG = 0.2825  

2024-07-19 11:55:33.176246: 
2024-07-19 11:55:33.176246: Start to re-build kg
2024-07-19 11:55:34.374247: KG built!
2024-07-19 11:55:40.022254: Epoch 36/40, Train: Loss = 0.1000, recLoss = 0.0770, clLoss = 0.0176, diLoss = 0.0027, CKDLoss = 2.6383  
2024-07-19 11:55:40.555255: Epoch 36/40, Test: Recall = 0.2997, NDCG = 0.2816  

2024-07-19 11:55:41.389256: 
2024-07-19 11:55:41.389256: Start to re-build kg
2024-07-19 11:55:42.691257: KG built!
2024-07-19 11:55:48.337264: Epoch 37/40, Train: Loss = 0.0986, recLoss = 0.0757, clLoss = 0.0174, diLoss = 0.0029, CKDLoss = 3.1382  
2024-07-19 11:55:48.879265: Epoch 37/40, Test: Recall = 0.2981, NDCG = 0.2793  

2024-07-19 11:55:49.666266: 
2024-07-19 11:55:49.666266: Start to re-build kg
2024-07-19 11:55:50.965267: KG built!
2024-07-19 11:55:56.611274: Epoch 38/40, Train: Loss = 0.0978, recLoss = 0.0751, clLoss = 0.0170, diLoss = 0.0036, CKDLoss = 9.6980  
2024-07-19 11:55:57.151275: Epoch 38/40, Test: Recall = 0.2955, NDCG = 0.2761  

2024-07-19 11:55:57.952277: 
2024-07-19 11:55:57.952277: Start to re-build kg
2024-07-19 11:55:59.173277: KG built!
2024-07-19 11:56:04.913285: Epoch 39/40, Train: Loss = 0.0969, recLoss = 0.0744, clLoss = 0.0168, diLoss = 0.0041, CKDLoss = 14.3655  
2024-07-19 11:56:05.438285: Epoch 39/40, Test: Recall = 0.2949, NDCG = 0.2760  

Best epoch :  16  , Recall :  0.32694861587412166  , NDCG :  0.3059266604830635