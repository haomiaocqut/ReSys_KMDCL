Begin to load knowledge graph triples ...
100%|##########| 171516/171516 [00:00<00:00, 1078714.29it/s]
kg shape:  (24176, 24176)
number of edges in KG:  47204
2024-07-16 14:43:29.813263: Load Data
USER 16308 ITEM 11516
NUM OF INTERACTIONS 159302
2024-07-16 14:43:30.714263: Model Prepared
2024-07-16 14:43:30.714263: Model Initialized
2024-07-16 14:43:35.490773: 
2024-07-16 14:43:35.490773: Start to re-build kg
2024-07-16 14:43:42.857781: KG built!
2024-07-16 14:43:47.738788: Epoch 0/40, Train: Loss = 2.0952, recLoss = 0.3217, clLoss = 1.7734, diLoss = 0.0005, CKDLoss = 0.0001  
2024-07-16 14:43:48.984790: Epoch 0/40, Test: Recall = 0.0721, NDCG = 0.0393  

2024-07-16 14:43:53.289794: 
2024-07-16 14:43:53.289794: Start to re-build kg
2024-07-16 14:44:00.708307: KG built!
2024-07-16 14:44:05.566817: Epoch 1/40, Train: Loss = 1.9595, recLoss = 0.2051, clLoss = 1.7541, diLoss = 0.0005, CKDLoss = 0.7058  
2024-07-16 14:44:06.813818: Epoch 1/40, Test: Recall = 0.0798, NDCG = 0.0432  

2024-07-16 14:44:11.207824: 
2024-07-16 14:44:11.207824: Start to re-build kg
2024-07-16 14:44:18.589833: KG built!
2024-07-16 14:44:23.397839: Epoch 2/40, Train: Loss = 1.9131, recLoss = 0.1658, clLoss = 1.7469, diLoss = 0.0016, CKDLoss = 2.1413  
2024-07-16 14:44:24.618840: Epoch 2/40, Test: Recall = 0.0867, NDCG = 0.0468  

2024-07-16 14:44:28.959845: 
2024-07-16 14:44:28.959845: Start to re-build kg
2024-07-16 14:44:36.171854: KG built!
2024-07-16 14:44:40.953860: Epoch 3/40, Train: Loss = 1.8832, recLoss = 0.1405, clLoss = 1.7421, diLoss = 0.0033, CKDLoss = 4.1549  
2024-07-16 14:44:42.199862: Epoch 3/40, Test: Recall = 0.0890, NDCG = 0.0485  

2024-07-16 14:44:46.515867: 
2024-07-16 14:44:46.515867: Start to re-build kg
2024-07-16 14:44:53.846876: KG built!
2024-07-16 14:44:58.686882: Epoch 4/40, Train: Loss = 1.8585, recLoss = 0.1193, clLoss = 1.7385, diLoss = 0.0015, CKDLoss = 2.8078  
2024-07-16 14:44:59.939883: Epoch 4/40, Test: Recall = 0.0924, NDCG = 0.0502  

2024-07-16 14:45:04.327890: 
2024-07-16 14:45:04.327890: Start to re-build kg
2024-07-16 14:45:11.690898: KG built!
2024-07-16 14:45:16.583904: Epoch 5/40, Train: Loss = 1.8427, recLoss = 0.1063, clLoss = 1.7356, diLoss = 0.0048, CKDLoss = 12.2627  
2024-07-16 14:45:17.846905: Epoch 5/40, Test: Recall = 0.0959, NDCG = 0.0520  

2024-07-16 14:45:22.173911: 
2024-07-16 14:45:22.173911: Start to re-build kg
2024-07-16 14:45:29.642920: KG built!
2024-07-16 14:45:34.495933: Epoch 6/40, Train: Loss = 1.8289, recLoss = 0.0950, clLoss = 1.7329, diLoss = 0.0096, CKDLoss = 10.6463  
2024-07-16 14:45:35.744935: Epoch 6/40, Test: Recall = 0.0963, NDCG = 0.0530  

2024-07-16 14:45:40.104940: 
2024-07-16 14:45:40.104940: Start to re-build kg
2024-07-16 14:45:47.498949: KG built!
2024-07-16 14:45:52.318956: Epoch 7/40, Train: Loss = 1.8163, recLoss = 0.0841, clLoss = 1.7310, diLoss = 0.0067, CKDLoss = 3.1900  
2024-07-16 14:45:53.587957: Epoch 7/40, Test: Recall = 0.0975, NDCG = 0.0541  

2024-07-16 14:45:57.955962: 
2024-07-16 14:45:57.955962: Start to re-build kg
2024-07-16 14:46:05.378971: KG built!
2024-07-16 14:46:10.207977: Epoch 8/40, Train: Loss = 1.8070, recLoss = 0.0765, clLoss = 1.7291, diLoss = 0.0051, CKDLoss = 1.8554  
2024-07-16 14:46:11.466482: Epoch 8/40, Test: Recall = 0.0987, NDCG = 0.0541  

2024-07-16 14:46:15.948488: 
2024-07-16 14:46:15.948488: Start to re-build kg
2024-07-16 14:46:23.202496: KG built!
2024-07-16 14:46:28.015006: Epoch 9/40, Train: Loss = 1.7997, recLoss = 0.0704, clLoss = 1.7278, diLoss = 0.0038, CKDLoss = 0.8406  
2024-07-16 14:46:29.259007: Epoch 9/40, Test: Recall = 0.0989, NDCG = 0.0546  

2024-07-16 14:46:33.598013: 
2024-07-16 14:46:33.598013: Start to re-build kg
2024-07-16 14:46:41.076022: KG built!
2024-07-16 14:46:45.875028: Epoch 10/40, Train: Loss = 1.7920, recLoss = 0.0638, clLoss = 1.7266, diLoss = 0.0062, CKDLoss = 2.0149  
2024-07-16 14:46:47.105029: Epoch 10/40, Test: Recall = 0.0985, NDCG = 0.0543  

2024-07-16 14:46:51.427034: 
2024-07-16 14:46:51.427034: Start to re-build kg
2024-07-16 14:46:58.788043: KG built!
2024-07-16 14:47:03.518050: Epoch 11/40, Train: Loss = 1.7859, recLoss = 0.0587, clLoss = 1.7254, diLoss = 0.0034, CKDLoss = 3.1470  
2024-07-16 14:47:04.746050: Epoch 11/40, Test: Recall = 0.0991, NDCG = 0.0546  

2024-07-16 14:47:09.162056: 
2024-07-16 14:47:09.162056: Start to re-build kg
2024-07-16 14:47:16.587065: KG built!
2024-07-16 14:47:21.345071: Epoch 12/40, Train: Loss = 1.7812, recLoss = 0.0550, clLoss = 1.7243, diLoss = 0.0017, CKDLoss = 16.1849  
2024-07-16 14:47:22.569072: Epoch 12/40, Test: Recall = 0.0987, NDCG = 0.0541  

2024-07-16 14:47:26.872078: 
2024-07-16 14:47:26.872078: Start to re-build kg
2024-07-16 14:47:34.325087: KG built!
2024-07-16 14:47:39.105092: Epoch 13/40, Train: Loss = 1.7765, recLoss = 0.0510, clLoss = 1.7235, diLoss = 0.0015, CKDLoss = 13.0818  
2024-07-16 14:47:40.348094: Epoch 13/40, Test: Recall = 0.0981, NDCG = 0.0539  

2024-07-16 14:47:44.662099: 
2024-07-16 14:47:44.662099: Start to re-build kg
2024-07-16 14:47:52.101108: KG built!
2024-07-16 14:47:56.894115: Epoch 14/40, Train: Loss = 1.7726, recLoss = 0.0477, clLoss = 1.7226, diLoss = 0.0013, CKDLoss = 0.9027  
2024-07-16 14:47:58.129116: Epoch 14/40, Test: Recall = 0.0963, NDCG = 0.0531  

2024-07-16 14:48:02.512122: 
2024-07-16 14:48:02.512122: Start to re-build kg
2024-07-16 14:48:09.804130: KG built!
2024-07-16 14:48:14.689136: Epoch 15/40, Train: Loss = 1.7696, recLoss = 0.0452, clLoss = 1.7220, diLoss = 0.0032, CKDLoss = 1.0816  
2024-07-16 14:48:15.932138: Epoch 15/40, Test: Recall = 0.0959, NDCG = 0.0533  

2024-07-16 14:48:20.291144: 
2024-07-16 14:48:20.291144: Start to re-build kg
2024-07-16 14:48:27.669152: KG built!
2024-07-16 14:48:32.448660: Epoch 16/40, Train: Loss = 1.7660, recLoss = 0.0422, clLoss = 1.7213, diLoss = 0.0011, CKDLoss = 2.5400  
2024-07-16 14:48:33.715662: Epoch 16/40, Test: Recall = 0.0981, NDCG = 0.0538  

2024-07-16 14:48:38.069668: 
2024-07-16 14:48:38.069668: Start to re-build kg
2024-07-16 14:48:45.512676: KG built!
2024-07-16 14:48:50.271682: Epoch 17/40, Train: Loss = 1.7631, recLoss = 0.0396, clLoss = 1.7209, diLoss = 0.0012, CKDLoss = 5.8201  
2024-07-16 14:48:51.487684: Epoch 17/40, Test: Recall = 0.0960, NDCG = 0.0533  

2024-07-16 14:48:55.929689: 
2024-07-16 14:48:55.929689: Start to re-build kg
2024-07-16 14:49:03.374698: KG built!
2024-07-16 14:49:08.226704: Epoch 18/40, Train: Loss = 1.7604, recLoss = 0.0373, clLoss = 1.7203, diLoss = 0.0011, CKDLoss = 17.1654  
2024-07-16 14:49:09.472706: Epoch 18/40, Test: Recall = 0.0957, NDCG = 0.0533  

2024-07-16 14:49:13.825711: 
2024-07-16 14:49:13.825711: Start to re-build kg
2024-07-16 14:49:21.322720: KG built!
2024-07-16 14:49:26.048726: Epoch 19/40, Train: Loss = 1.7585, recLoss = 0.0357, clLoss = 1.7199, diLoss = 0.0045, CKDLoss = 63.9356  
2024-07-16 14:49:27.272728: Epoch 19/40, Test: Recall = 0.0955, NDCG = 0.0532  

2024-07-16 14:49:31.623058: 
2024-07-16 14:49:31.623058: Start to re-build kg
2024-07-16 14:49:39.109067: KG built!
2024-07-16 14:49:43.835074: Epoch 20/40, Train: Loss = 1.7557, recLoss = 0.0331, clLoss = 1.7195, diLoss = 0.0312, CKDLoss = 11.9092  
2024-07-16 14:49:45.061074: Epoch 20/40, Test: Recall = 0.0929, NDCG = 0.0528  

2024-07-16 14:49:49.411080: 
2024-07-16 14:49:49.411080: Start to re-build kg
2024-07-16 14:49:56.926508: KG built!
2024-07-16 14:50:01.663514: Epoch 21/40, Train: Loss = 1.7542, recLoss = 0.0318, clLoss = 1.7192, diLoss = 0.0357, CKDLoss = 2.2993  
2024-07-16 14:50:02.917515: Epoch 21/40, Test: Recall = 0.0922, NDCG = 0.0524  

2024-07-16 14:50:07.256521: 
2024-07-16 14:50:07.257521: Start to re-build kg
2024-07-16 14:50:14.543529: KG built!
2024-07-16 14:50:19.359535: Epoch 22/40, Train: Loss = 1.7524, recLoss = 0.0303, clLoss = 1.7188, diLoss = 0.0345, CKDLoss = 0.2225  
2024-07-16 14:50:20.633537: Epoch 22/40, Test: Recall = 0.0908, NDCG = 0.0518  

2024-07-16 14:50:25.000542: 
2024-07-16 14:50:25.000542: Start to re-build kg
2024-07-16 14:50:32.427551: KG built!
2024-07-16 14:50:37.218948: Epoch 23/40, Train: Loss = 1.7503, recLoss = 0.0284, clLoss = 1.7185, diLoss = 0.0343, CKDLoss = 0.0446  
2024-07-16 14:50:38.431949: Epoch 23/40, Test: Recall = 0.0917, NDCG = 0.0518  

2024-07-16 14:50:42.816219: 
2024-07-16 14:50:42.816219: Start to re-build kg
2024-07-16 14:50:50.135228: KG built!
2024-07-16 14:50:54.964233: Epoch 24/40, Train: Loss = 1.7499, recLoss = 0.0282, clLoss = 1.7182, diLoss = 0.0348, CKDLoss = 0.0284  
2024-07-16 14:50:56.200235: Epoch 24/40, Test: Recall = 0.0910, NDCG = 0.0514  

2024-07-16 14:51:00.611240: 
2024-07-16 14:51:00.611240: Start to re-build kg
2024-07-16 14:51:08.078250: KG built!
2024-07-16 14:51:12.874262: Epoch 25/40, Train: Loss = 1.7485, recLoss = 0.0269, clLoss = 1.7180, diLoss = 0.0353, CKDLoss = 0.0081  
2024-07-16 14:51:14.143264: Epoch 25/40, Test: Recall = 0.0908, NDCG = 0.0513  

2024-07-16 14:51:18.417269: 
2024-07-16 14:51:18.417269: Start to re-build kg
2024-07-16 14:51:25.925278: KG built!
2024-07-16 14:51:30.763285: Epoch 26/40, Train: Loss = 1.7466, recLoss = 0.0250, clLoss = 1.7178, diLoss = 0.0357, CKDLoss = 0.0045  
2024-07-16 14:51:32.001286: Epoch 26/40, Test: Recall = 0.0905, NDCG = 0.0514  

2024-07-16 14:51:36.305291: 
2024-07-16 14:51:36.305291: Start to re-build kg
2024-07-16 14:51:43.722300: KG built!
2024-07-16 14:51:48.576306: Epoch 27/40, Train: Loss = 1.7458, recLoss = 0.0244, clLoss = 1.7175, diLoss = 0.0325, CKDLoss = 0.0026  
2024-07-16 14:51:49.837307: Epoch 27/40, Test: Recall = 0.0899, NDCG = 0.0509  

2024-07-16 14:51:54.158313: 
2024-07-16 14:51:54.158313: Start to re-build kg
2024-07-16 14:52:01.704322: KG built!
2024-07-16 14:52:06.554329: Epoch 28/40, Train: Loss = 1.7448, recLoss = 0.0235, clLoss = 1.7173, diLoss = 0.0330, CKDLoss = 0.0020  
2024-07-16 14:52:07.792329: Epoch 28/40, Test: Recall = 0.0902, NDCG = 0.0507  

2024-07-16 14:52:12.127335: 
2024-07-16 14:52:12.127335: Start to re-build kg
2024-07-16 14:52:19.502345: KG built!
2024-07-16 14:52:24.331853: Epoch 29/40, Train: Loss = 1.7437, recLoss = 0.0224, clLoss = 1.7171, diLoss = 0.0311, CKDLoss = 0.0017  
2024-07-16 14:52:25.554855: Epoch 29/40, Test: Recall = 0.0885, NDCG = 0.0500  

2024-07-16 14:52:29.835860: 
2024-07-16 14:52:29.835860: Start to re-build kg
2024-07-16 14:52:37.272869: KG built!
2024-07-16 14:52:42.066876: Epoch 30/40, Train: Loss = 1.7430, recLoss = 0.0219, clLoss = 1.7169, diLoss = 0.0346, CKDLoss = 0.0016  
2024-07-16 14:52:43.296877: Epoch 30/40, Test: Recall = 0.0881, NDCG = 0.0499  

2024-07-16 14:52:47.614882: 
2024-07-16 14:52:47.614882: Start to re-build kg
2024-07-16 14:52:55.018891: KG built!
2024-07-16 14:52:59.854897: Epoch 31/40, Train: Loss = 1.7426, recLoss = 0.0215, clLoss = 1.7168, diLoss = 0.0322, CKDLoss = 0.0014  
2024-07-16 14:53:01.119898: Epoch 31/40, Test: Recall = 0.0876, NDCG = 0.0496  

2024-07-16 14:53:05.440903: 
2024-07-16 14:53:05.440903: Start to re-build kg
2024-07-16 14:53:12.933913: KG built!
2024-07-16 14:53:17.786919: Epoch 32/40, Train: Loss = 1.7420, recLoss = 0.0209, clLoss = 1.7166, diLoss = 0.0318, CKDLoss = 0.0013  
2024-07-16 14:53:19.001920: Epoch 32/40, Test: Recall = 0.0869, NDCG = 0.0496  

2024-07-16 14:53:23.301925: 
2024-07-16 14:53:23.301925: Start to re-build kg
2024-07-16 14:53:30.636935: KG built!
2024-07-16 14:53:35.398443: Epoch 33/40, Train: Loss = 1.7408, recLoss = 0.0198, clLoss = 1.7165, diLoss = 0.0327, CKDLoss = 0.0016  
2024-07-16 14:53:36.626444: Epoch 33/40, Test: Recall = 0.0856, NDCG = 0.0488  

2024-07-16 14:53:40.969450: 
2024-07-16 14:53:40.969450: Start to re-build kg
2024-07-16 14:53:48.348962: KG built!
2024-07-16 14:53:53.158473: Epoch 34/40, Train: Loss = 1.7401, recLoss = 0.0191, clLoss = 1.7164, diLoss = 0.0324, CKDLoss = 0.0018  
2024-07-16 14:53:54.430474: Epoch 34/40, Test: Recall = 0.0858, NDCG = 0.0485  

2024-07-16 14:53:58.806479: 
2024-07-16 14:53:58.806479: Start to re-build kg
2024-07-16 14:54:06.354488: KG built!
2024-07-16 14:54:11.126495: Epoch 35/40, Train: Loss = 1.7397, recLoss = 0.0187, clLoss = 1.7163, diLoss = 0.0315, CKDLoss = 0.0014  
2024-07-16 14:54:12.341998: Epoch 35/40, Test: Recall = 0.0840, NDCG = 0.0480  

2024-07-16 14:54:16.626004: 
2024-07-16 14:54:16.626004: Start to re-build kg
2024-07-16 14:54:24.070013: KG built!
2024-07-16 14:54:28.902018: Epoch 36/40, Train: Loss = 1.7392, recLoss = 0.0183, clLoss = 1.7162, diLoss = 0.0341, CKDLoss = 0.0011  
2024-07-16 14:54:30.132020: Epoch 36/40, Test: Recall = 0.0826, NDCG = 0.0474  

2024-07-16 14:54:34.473025: 
2024-07-16 14:54:34.473025: Start to re-build kg
2024-07-16 14:54:41.775034: KG built!
2024-07-16 14:54:46.594040: Epoch 37/40, Train: Loss = 1.7389, recLoss = 0.0180, clLoss = 1.7160, diLoss = 0.0334, CKDLoss = 0.0015  
2024-07-16 14:54:47.833042: Epoch 37/40, Test: Recall = 0.0823, NDCG = 0.0470  

2024-07-16 14:54:52.183047: 
2024-07-16 14:54:52.183047: Start to re-build kg
2024-07-16 14:54:59.595056: KG built!
2024-07-16 14:55:04.367063: Epoch 38/40, Train: Loss = 1.7382, recLoss = 0.0172, clLoss = 1.7160, diLoss = 0.0340, CKDLoss = 0.0011  
2024-07-16 14:55:05.599064: Epoch 38/40, Test: Recall = 0.0816, NDCG = 0.0469  

2024-07-16 14:55:09.961573: 
2024-07-16 14:55:09.961573: Start to re-build kg
2024-07-16 14:55:17.280086: KG built!
2024-07-16 14:55:22.139092: Epoch 39/40, Train: Loss = 1.7371, recLoss = 0.0162, clLoss = 1.7158, diLoss = 0.0311, CKDLoss = 0.0011  
2024-07-16 14:55:23.402093: Epoch 39/40, Test: Recall = 0.0814, NDCG = 0.0466  

Best epoch :  11  , Recall :  0.09912191021973567  , NDCG :  0.05461436084152347